ğŸ’¡ Spring Boot ã§ç°¡å˜ãªãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ä½œã‚‹
ã‚ãªãŸã®ç›®çš„ã¯ã€ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’ä¿å­˜ã—ã¦ã€æ¬¡å›é–‹ã„ãŸã¨ãã«å¾©å…ƒã™ã‚‹ã“ã¨ ãªã®ã§ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

ã‚²ãƒ¼ãƒ é–‹å§‹ (æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’ä½œã‚‹)
ãƒãƒ¼ã‚¯ã‚’ã¤ã‘ã‚‹ (ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰ä¿å­˜)
ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’å–å¾— (æ¬¡å›é–‹ã„ãŸã¨ãã«å¾©å…ƒ)
1. Spring Boot ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
Spring Boot ã¯ã€Spring Initializr ã‚’ä½¿ãˆã°ç°¡å˜ã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ãã¾ã™ã€‚

ğŸ’¡ Spring Boot ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆæ–¹æ³•
ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã§å¿…è¦ãªè¨­å®šã‚’ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
ğŸ‘‰ Spring Initializr

âœ… é¸æŠã™ã‚‹è¨­å®š

Project: Maven
Language: Java
Spring Boot: 3.1.0 (æœ€æ–°)
Dependencies:
Spring Web (REST APIã‚’ä½œã‚‹)
Spring Boot DevTools (é–‹ç™ºã‚’å¿«é©ã«)
Spring Data JPA (ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜)
H2 Database (ç°¡å˜ãªDB)
âš¡ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦è§£å‡ã—ã€IDE (VSCode / IntelliJ) ã§é–‹ã

2. GameController.java (APIã®ä½œæˆ)
Spring Boot ã§REST APIã‚’ä½œæˆã—ã¾ã™ã€‚

# java
package com.example.tictactoe.controller;

import org.springframework.web.bind.annotation.*;
import java.util.HashMap;
import java.util.Map;

@RestController
@RequestMapping("/game")
public class GameController {

    private Map<String, String[]> games = new HashMap<>(); // ãƒ¡ãƒ¢ãƒªå†…ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ

    @PostMapping("/start")
    public Map<String, String> startGame(@RequestParam String gameId) {
        if (!games.containsKey(gameId)) {
            games.put(gameId, new String[9]); // 9ãƒã‚¹ã®ç©ºã®ã‚²ãƒ¼ãƒ ã‚’ä½œæˆ
        }
        return Map.of("message", "Game started");
    }

    @PostMapping("/move")
    public Map<String, Object> makeMove(@RequestParam String gameId, @RequestParam int index, @RequestParam String player) {
        if (!games.containsKey(gameId)) {
            return Map.of("error", "Game not found");
        }

        String[] board = games.get(gameId);

        if (board[index] != null) {
            return Map.of("error", "Cell already occupied");
        }

        board[index] = player;
        return Map.of("message", "Move registered", "board", board);
    }

    @GetMapping("/state")
    public Map<String, Object> getGameState(@RequestParam String gameId) {
        if (!games.containsKey(gameId)) {
            return Map.of("error", "Game not found");
        }
        return Map.of("board", games.get(gameId));
    }
}


3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã®é€£æº
ã“ã®Spring Bootã‚µãƒ¼ãƒãƒ¼ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨é€£æºã•ã›ã‚‹ã«ã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã® handleClick ã‚’ä¿®æ­£ ã—ã¾ã™ã€‚

# tsx
const gameId = "abc123"; // ã‚²ãƒ¼ãƒ ã®IDã‚’å›ºå®šï¼ˆãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãªã‚‰å‹•çš„ã«ã™ã‚‹ï¼‰

useEffect(() => {
    fetch(`http://localhost:8080/game/state?gameId=${gameId}`)
        .then(res => res.json())
        .then(data => {
            if (data.board) {
                setClickedMarks(data.board.reduce((acc, mark, idx) => {
                    acc[idx] = mark || "";
                    return acc;
                }, {} as { [key: number]: "â—" | "Ã—" | "" }));
            }
        });
}, []);

const handleClick = async (id: number) => {
    if (clickedMarks[id]) return;

    const response = await fetch(`http://localhost:8080/game/move?gameId=${gameId}&index=${id}&player=${nextMark}`, {
        method: "POST",
    });

    const data = await response.json();
    if (data.error) {
        alert(data.error);
        return;
    }

    setClickedMarks(data.board.reduce((acc, mark, idx) => {
        acc[idx] = mark || "";
        return acc;
    }, {} as { [key: number]: "â—" | "Ã—" | "" }));

    setNextMark(prev => (prev === "â—" ? "Ã—" : "â—"));
};


4. Spring Bootã®èµ·å‹•
ğŸ’¡ ã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè¡Œ
bash
./mvnw spring-boot:run
ã¾ãŸã¯ã€IntelliJãªã‚‰ GameApplication.java ã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦ Run ã™ã‚Œã°OKï¼

ğŸ¯ ã“ã‚Œã§ã§ãã‚‹ã“ã¨
âœ… ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ãŒã‚µãƒ¼ãƒãƒ¼ã§ç®¡ç†ã•ã‚Œã‚‹
âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’é–‰ã˜ã¦ã‚‚ã€é–‹ã„ãŸã¨ãã«å¾©å…ƒã•ã‚Œã‚‹
âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãªã—ã§ã‚·ãƒ³ãƒ—ãƒ«ãªç®¡ç†ãŒå¯èƒ½

ğŸ’¡ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ (H2ã‚„PostgreSQL)
å‹æ•—åˆ¤å®šã‚’è¿½åŠ 
WebSocket ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ (ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å¯¾æˆ¦)
ã¾ãšã¯ã“ã®Spring Bootã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’è©¦ã—ã¦ã¿ã¦ã€æ…£ã‚ŒãŸã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ã†ã¨å®Ÿè·µçš„ãªã‚¢ãƒ—ãƒªã«ãªã‚Šã¾ã™ï¼